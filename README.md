# ü§ñ Model Interface ‚Äî –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è VLM-–º–æ–¥–µ–ª–µ–π

[![Python 3.10+](https://img.shields.io/badge/Python-3.10+-blue.svg)](https://www.python.org/downloads/)
[![Poetry](https://img.shields.io/badge/dependencies-poetry-green)](https://python-poetry.org/)

**Model Interface** ‚Äî —ç—Ç–æ –≥–∏–±–∫–∏–π python-–ø–∞–∫–µ—Ç –¥–ª—è —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å VLM-–º–æ–¥–µ–ª—è–º–∏ –¥–ª—è `VLMHyperBench`([—Å—Å—ã–ª–∫–∞](https://github.com/VLMHyperBenchTeam/VLMHyperBench)).

–ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∏ –≤ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.

**–°–æ–∑–¥–∞–Ω–∞ –¥–ª—è:**
- –ë—ã—Å—Ç—Ä–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è VLM-–º–æ–¥–µ–ª–µ–π (`–±–∞–∑–∞`: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, `prompt`: —Ç–µ–∫—Å—Ç, `output`: —Ç–µ–∫—Å—Ç)
- –ï–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å VLM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–∞–∑–Ω—ã–º–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞–º–∏ (`Hugging Face`, `vLLM`, `SGLang`)
- –û—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–µ–π

**–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ:**
- –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ VLM –∏ –ø–æ—Ç—Ä–µ–±–ª—è–µ–º—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤

## üöÄ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

‚ú® **–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**:
- **–§–∞–±—Ä–∏–∫–∞ –º–æ–¥–µ–ª–µ–π** ‚Äî –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è VLM –º–æ–¥–µ–ª–µ–π –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –≤ `ModelFactory` –∏–∑ –≤–∞—à–∏—Ö python-–ø–∞–∫–µ—Ç–æ–≤ –≤—Å–µ–≥–æ –∑–∞ 2 —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞
- **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** ‚Äî –µ–¥–∏–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ –≤—Å–µ–º–∏ VLM-–º–æ–¥–µ–ª—è–º–∏ (—É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–Ω—ã–º–∏ –æ—Ç `ModelInterface`)
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏** ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ –≤ —É–∫–∞–∑–∞–Ω–Ω—É—é –≤–∞–º–∏ –ø–∞–ø–∫—É `cache_dir` –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞–º–∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ —á–µ—Ä–µ–∑ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –∫–ª–∞—Å—Å—ã `ModelFactory` –∏ `ModelInterface`.

## üèõÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **ModelFactory**: –§–∞–±—Ä–∏—á–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ —Å–æ–∑–¥–∞–Ω–∏—è —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –º–æ–¥–µ–ª–µ–π –∏–∑ python-–ø–∞–∫–µ—Ç–æ–≤.
- **ModelInterface**: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å–Ω—ã–π –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å VLM.

![Architecture](repo_pics/Architecture.jpg)

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

TODO: —Å–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è —Å—Å—ã–ª–∫–∞.

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ß–µ—Ä–µ–∑ Poetry
poetry add model-interface

# –ò–ª–∏ —á–µ—Ä–µ–∑ pip
pip install model-interface
```

## üõ† –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–∏

```python
from model_interface.model_factory import ModelFactory

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏
ModelFactory.register_model(
    model_name="my_custom_model",
    model_path="my_ml_models.module:MyModelClass"
)
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞
```python
model = ModelFactory.get_model(
    model_name="my_custom_model",
    model_init_params={
        "system_prompt": "–¢—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º",
        "cache_dir": "/tmp/model_cache"
    }
)
```

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
```python
# –î–ª—è –æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
result = model.predict_on_image(image_object, "–ß—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–æ –Ω–∞ —Ñ–æ—Ç–æ?")

# –î–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
results = model.predict_on_images([img1, img2], "–°—Ä–∞–≤–Ω–∏ —ç—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã")
```

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
model_interface/
‚îú‚îÄ‚îÄ model_factory.py  ‚Äî –§–∞–±—Ä–∏–∫–∞ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ model_interface.py ‚Äî –ë–∞–∑–æ–≤—ã–π –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
‚îî‚îÄ‚îÄ model_utils.py    ‚Äî –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
tests/                ‚Äî Unit-—Ç–µ—Å—Ç—ã (–ø–æ–∫–∞ –ø—É—Å—Ç—ã–µ)
pyproject.toml        ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è Poetry
```

## üì¶ –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Python-–ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è VLM

–≠—Ç–æ—Ç –ø–∞–∫–µ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö:

### –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å "—à—É—Ç–æ—á–Ω–æ–π" –º–æ–¥–µ–ª—å—é

   –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—è.

1. **[model_qwen2_vl_example](https://github.com/VLMHyperBenchTeam/model_qwen2_vl_example)**  
   
   –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ `ModelFactory`
   - –†–µ–∞–ª–∏–∑–∞—Ü–∏—é –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ `ModelInterface`
   - –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –≤ `example.py`

### –ü—Ä–∏–º–µ—Ä—ã —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö python-–ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è VLM

1. **[model_qwen2-vl](https://github.com/VLMHyperBenchTeam/model_qwen2-vl)**

   –†–µ–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è —Å–µ–º–µ–π—Å—Ç–≤–∞ –º–æ–¥–µ–ª–µ–π Qwen2-VL:
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 2B/7B –≤–µ—Ä—Å–∏–π
   - –§—Ä–µ–π–º–≤–æ—Ä–∫ Hugging Face
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å —Ä–µ–≥—É–ª–∏—Ä—É–µ–º—ã–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º
   - –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ (—Å—á–µ—Ç–∞, –Ω–∞–∫–ª–∞–¥–Ω—ã–µ)

2. **[model_qwen2_5_vl](https://github.com/VLMHyperBenchTeam/model_qwen2.5-vl)**  
   –†–µ–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è —Å–µ–º–µ–π—Å—Ç–≤–∞ –º–æ–¥–µ–ª–µ–π Qwen2.5-VL:
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 2B/7B –≤–µ—Ä—Å–∏–π
   - –§—Ä–µ–π–º–≤–æ—Ä–∫ Hugging Face
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å —Ä–µ–≥—É–ª–∏—Ä—É–µ–º—ã–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º
   - –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ (—Å—á–µ—Ç–∞, –Ω–∞–∫–ª–∞–¥–Ω—ã–µ)
